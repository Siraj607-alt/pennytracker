<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Savings • Penny Tracker</title>

  <style>
    body {
    margin: 0;
    font-family: Inter, sans-serif;

    background:
        radial-gradient(circle at top left, #eaf2ff 0%, #f5f6fa 35%, #edf1f7 100%),
        linear-gradient(180deg, #f8fafc, #eef2f7);

    min-height: 100vh;
}



     /* NAVBAR */
     .navbar {
         background: white;
         padding: 15px 30px;
         display: flex;
         justify-content: space-between;
         align-items: center;
         box-shadow: 0 2px 10px rgba(0,0,0,0.08);
     }

     .nav-links a {
         margin: 0 15px;
         text-decoration: none;
         color: #555;
         font-weight: 500;
     }

     .nav-links a:hover {
         color: #4A90E2;
     }

     .logout {
         color: #d9534f;
         font-weight: 600;
         text-decoration: none;
     }

  .container {
    max-width: 1100px;
    margin: 40px auto;
    padding: 30px;

    /* GLASS LAYER */
    background: rgba(255, 255, 255, 0.82);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);

    border-radius: 22px;

    box-shadow:
        0 20px 45px rgba(0, 0, 0, 0.12),
        inset 0 1px 0 rgba(255,255,255,0.7);
}


     .overview {
         display: grid;
         grid-template-columns: repeat(2, 1fr);
         gap: 20px;
         margin-bottom: 35px;
     }

     .overview-card {
         background: white;
         padding: 22px;
         border-radius: 14px;
         box-shadow: 0 4px 12px rgba(0,0,0,0.08);
     }

     .overview-card label {
         font-size: 14px;
         color: #666;
     }

     .overview-card h3 {
         margin: 8px 0 0;
         font-size: 26px;
     }

     .savings-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
         gap: 25px;
     }

.goal-card {
    background: rgba(255, 255, 255, 0.92);
    padding: 22px;
    border-radius: 18px;

    box-shadow:
        0 10px 28px rgba(0,0,0,0.10),
        inset 0 1px 0 rgba(255,255,255,0.8);

    transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.goal-card:hover {
    transform: translateY(-6px);
    box-shadow:
        0 18px 40px rgba(0,0,0,0.15),
        inset 0 1px 0 rgba(255,255,255,0.9);
}





     .goal-amount {
         margin: 10px 0;
         font-size: 14px;
         color: #555;
     }

     .progress-track {
    background: linear-gradient(90deg, #e4e7ec, #f1f3f7);
    height: 10px;
    border-radius: 12px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4A90E2, #6CB2FF);
    border-radius: 12px;
    transition: width 0.4s ease;
}


     .goal-footer {
         display: flex;
         justify-content: space-between;
         align-items: center;
         font-size: 14px;
     }

     .add-btn {
         background: #eef4ff;
         border: none;
         color: #4A90E2;
         padding: 6px 14px;
         border-radius: 8px;
         cursor: pointer;
         font-weight: 600;
     }

     .primary-btn {
         background: #4A90E2;
         color: white;
         border: none;
         padding: 12px;
         border-radius: 12px;
         cursor: pointer;
         font-size: 15px;
     }

     /* MODALS */
     .modal {
         display: none;
         position: fixed;
         inset: 0;
         background: rgba(0,0,0,0.45);
         backdrop-filter: blur(3px);
         z-index: 1000;
     }

     .modal-content {
         background: white;
         width: 380px;
         margin: 10% auto;
         padding: 25px;
         border-radius: 16px;
         box-shadow: 0 12px 30px rgba(0,0,0,0.25);
     }

     .modal-content input {
         width: 100%;
         padding: 10px;
         margin: 8px 0 14px;
         border-radius: 8px;
         border: 1px solid #ccc;
     }

     .saveBtn {
         width: 100%;
         padding: 10px;
         background: #4A90E2;
         border: none;
         color: white;
         border-radius: 10px;
         cursor: pointer;
     }

     .close {
         float: right;
         font-size: 22px;
         cursor: pointer;
     }
    .goal-title {
    font-size: 18px;
    font-weight: 700;
    color: #1f2937;
}

.goal-amount {
    font-size: 15px;
    color: #4b5563;
}

.goal-footer span {
    font-size: 13px;
    color: #6b7280;
}
    .container {
    outline: 3px solid #4A90E2;
}


  </style>
</head>
<body>


<!-- NAVBAR -->
<div class="navbar">
  <h2>Penny Tracker</h2>
  <div class="nav-links">
    <a href="/dashboard">Dashboard</a>
    <a href="/my-expenses">My Expenses</a>
    <a href="/savings">Savings</a>
    <a href="/profile">Profile</a>
  </div>
  <a href="/logout" class="logout">Logout</a>
</div>

<div class="container">
  <div th:if="${success}"
       style="
       background:#4CAF50;
       color:white;
       padding:12px 18px;
       border-radius:10px;
       margin-bottom:20px;
       font-weight:600;
     ">
    ✔ <span th:text="${success}"></span>
  </div>

  <div th:if="${error}"
       style="
       background:#e63946;
       color:white;
       padding:12px 18px;
       border-radius:10px;
       margin-bottom:20px;
       font-weight:600;
     ">
    ⚠ <span th:text="${error}"></span>
  </div>


  <!-- OVERVIEW -->
  <div class="overview">
    <div class="overview-card">
      <label>Total Saved</label>
      <h3>₹<span th:text="${totalSaved}">0</span></h3>
    </div>

    <div class="overview-card">
      <label>Active Goals</label>
      <h3 th:text="${goalCount}">0</h3>
    </div>
  </div>

  <!-- GOALS -->
  <div class="savings-grid">

    <div class="goal-card" th:each="g : ${goals}">
      <div class="goal-title" th:text="${g.name}"></div>

      <div class="goal-amount">
        ₹<span th:text="${g.savedAmount}"></span> /
        ₹<span th:text="${g.targetAmount}"></span>
      </div>

      <div style="font-size:14px; color:#666; margin-bottom:10px;">
        Remaining:
        ₹<span th:text="${g.targetAmount - g.savedAmount}"></span>
      </div>
      <div class="progress-track">
        <div class="progress-fill"
             th:style="'width:' + (${g.savedAmount} * 100 / ${g.targetAmount}) + '%'">
        </div>
      </div>
      <span th:if="${g.savedAmount >= g.targetAmount}"
            style="color:#2e7d32; font-weight:600;">
  ✔ Goal Completed
</span>


      <div class="goal-footer">
        <span th:text="${(g.savedAmount * 100 / g.targetAmount)} + '% completed'"></span>
        <button class="add-btn add-money-btn"
                th:data-goalid="${g.id}"
                th:disabled="${g.savedAmount >= g.targetAmount}"
                th:text="${g.savedAmount >= g.targetAmount ? 'Goal Completed' : 'Add Money'}"
                th:style="
          (${g.savedAmount >= g.targetAmount}) ?
          'opacity:0.6; cursor:not-allowed;' :
          'opacity:1; cursor:pointer;'
        ">
        </button>

      </div>
    </div>

    <button class="primary-btn" id="openGoalModal">+ Create Goal</button>
  </div>
</div>

<!-- CREATE GOAL MODAL -->
<div class="modal" id="goalModal">
  <div class="modal-content">
    <span class="close" id="closeGoalModal">&times;</span>
    <h3>Create Savings Goal</h3>

    <form action="/create-goal" method="post">
      <label>Goal Name</label>
      <input type="text" name="name" required>

      <label>Target Amount (₹)</label>
      <input type="number" name="targetAmount" required>

      <button type="submit" class="saveBtn">Create Goal</button>
    </form>
  </div>
</div>

<!-- ADD MONEY MODAL -->
<div class="modal" id="addMoneyModal">
  <div class="modal-content">
    <span class="close" id="closeAddMoney">&times;</span>
    <h3>Add Money</h3>

    <form action="/savings/add-money" method="post">
      <input type="hidden" name="goalId" id="goalIdField">
      <input type="number" name="amount" min="1" required>
      <button type="submit" class="saveBtn">Add</button>
    </form>
  </div>
</div>

<script>
  const goalModal = document.getElementById("goalModal");
  const addMoneyModal = document.getElementById("addMoneyModal");

  document.getElementById("openGoalModal").onclick = () => goalModal.style.display = "block";
  document.getElementById("closeGoalModal").onclick = () => goalModal.style.display = "none";
  document.getElementById("closeAddMoney").onclick = () => addMoneyModal.style.display = "none";

  document.querySelectorAll(".add-money-btn").forEach(btn => {
      btn.onclick = () => {
          document.getElementById("goalIdField").value = btn.dataset.goalid;
          addMoneyModal.style.display = "block";
      };
  });

  window.onclick = (e) => {
      if (e.target === goalModal) goalModal.style.display = "none";
      if (e.target === addMoneyModal) addMoneyModal.style.display = "none";
  };
</script>

</body>
</html>
